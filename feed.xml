<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="3.6.2">Jekyll</generator><link href="/feed.xml" rel="self" type="application/atom+xml" /><link href="/" rel="alternate" type="text/html" /><updated>2018-04-01T04:01:49+00:00</updated><id>/</id><title type="html">My Blog</title><subtitle>Description of my blog</subtitle><entry><title type="html">Installing Redis 4.0.9 on Ubuntu 16.04</title><link href="/installing-redis-4.0.9-on-ubuntu-16.04" rel="alternate" type="text/html" title="Installing Redis 4.0.9 on Ubuntu 16.04" /><published>2018-03-30T06:29:00+00:00</published><updated>2018-03-30T06:29:00+00:00</updated><id>/installing-redis-4.0.9-on-ubuntu-16.04</id><content type="html" xml:base="/installing-redis-4.0.9-on-ubuntu-16.04">&lt;h1 id=&quot;prerequisites&quot;&gt;Prerequisites&lt;/h1&gt;

&lt;p&gt;Redis 소스를 컴파일하고 설치하기 위해 필요한 패키지들을 설치합니다.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;apt-get update &lt;span class=&quot;nt&quot;&gt;-y&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;apt-get install gcc make
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;installing-redis&quot;&gt;Installing Redis&lt;/h1&gt;

&lt;p&gt;Redis 공식 사이트에서는 소스를 컴파일하여 설치하는 방법을 추천하고 있습니다.
이는, Linux 배포판의 패키지 관리자를 사용하여 설치할 경우 일반적으로 사용 가능한 버전이 최신이 아닐 수 있기 때문입니다.
Redis는 GCC 컴파일러와 libc 외에 다른 의존성이 없기 때문에 컴파일하여 설치하기 수월합니다.&lt;/p&gt;

&lt;p&gt;Redis를 컴파일하여 설치하기 위해 다음과 같이 작업합니다 (글 작성시의 Redis 버전은 &lt;code class=&quot;highlighter-rouge&quot;&gt;4.0.9&lt;/code&gt;입니다):&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;wget http://download.redis.io/redis-stable.tar.gz
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;tar &lt;/span&gt;xvzf redis-stable.tar.gz
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;redis-stable
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;make
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;컴파일이 정상적으로 완료되면 &lt;em&gt;src&lt;/em&gt; 디렉토리 내에 다음과 같은 실행가능한 바이너리들이 있는것을 확인할 수 있습니다:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;redis-server&lt;/strong&gt;: Redis 서버입니다. 서버를 구동할 때 사용합니다.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;redis-sentinel&lt;/strong&gt;: Redis 서버의 상태를 모니터링하고 장애 발생 시 복구하는 감시 프로그램입니다.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;redis-cli&lt;/strong&gt;: Redis를 사용하기 위한 Command Line Interface(CLI) 유틸입니다.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;redis-benchmark&lt;/strong&gt;: Redis의 성능을 테스트하기 위해 사용하는 프로그램입니다.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;redis-check-aof&lt;/strong&gt; and &lt;strong&gt;redis-check-dump&lt;/strong&gt;: 가끔 발생하는 데이터 손상시 유용합니다.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;다음 명령어를 통해 위의 바이너리 파일들을 설치(복사) 합니다:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;make install
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;설치되는 디렉토리는 기본값이 &lt;code class=&quot;highlighter-rouge&quot;&gt;usr/local/bin&lt;/code&gt;이며 PREFIX 값을 통해 원하는 곳에 설치 가능합니다:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;make &lt;span class=&quot;nv&quot;&gt;PREFIX&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/some/other/directory install
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;starting-redis&quot;&gt;Starting Redis&lt;/h1&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;redis-server&lt;/code&gt; 바이너리를 실행하여 서버가 정상적으로 동작하는지 확인합니다:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;redis-server
9308:C 28 Mar 05:09:25.302 &lt;span class=&quot;c&quot;&gt;# oO0OoO0OoO0Oo Redis is starting oO0OoO0OoO0Oo&lt;/span&gt;
9308:C 28 Mar 05:09:25.303 &lt;span class=&quot;c&quot;&gt;# Redis version=4.0.9, bits=64, commit=00000000, modified=0, pid=9308, just started&lt;/span&gt;
9308:C 28 Mar 05:09:25.303 &lt;span class=&quot;c&quot;&gt;# Configuration loaded&lt;/span&gt;
9309:M 28 Mar 05:09:25.305 &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; Increased maximum number of open files to 10032 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;it was originally &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;to 1024&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
... more logs ...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;redis-server&lt;/code&gt; 실행 시 아무 옵션을 주지 않으면 모든 설정값이 기본값을 사용하며, &lt;code class=&quot;highlighter-rouge&quot;&gt;redis-server /etc/redis.conf&lt;/code&gt;와 같이 설정 파일의 전체 경로를 첫번째 인자로 실행하면 설정 파일 내의 값들을 사용합니다.
Redis 소스 코드 내에 redis.conf 파일을 복사하여 서버에 맞게 설정하고 사용할 수 있습니다.&lt;/p&gt;

&lt;h1 id=&quot;check-if-redis-is-working&quot;&gt;Check if Redis is working&lt;/h1&gt;

&lt;p&gt;외부 프로그램들은 TCP 소켓과 Redis 프로토콜을 사용하여 Redis 서버와 통신할 수 있습니다.
Redis 프로토콜은 각 프로그래밍 언어에 맞게 라이브러리로 제공되며, 간단히 &lt;code class=&quot;highlighter-rouge&quot;&gt;redis-cli&lt;/code&gt;를 사용하여 Redis 서버로 명령을 보낼 수 있습니다.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;redis-cli&lt;/code&gt;를 사용하여 현재 서버가 동작하고, 연결 가능한지 확인합니다:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;redis-cli ping
PONG
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;명령어 실행후 &lt;strong&gt;PONG&lt;/strong&gt; 메시지를 받으면 서버가 정상적으로 동작하고 있는겁니다.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;redis-cli&lt;/code&gt;는 실행 인자가 없을 시, Redis 호스트는 localhost를, 포트는 6379를 기본값으로 사용합니다.
이는 &lt;code class=&quot;highlighter-rouge&quot;&gt;-h &amp;lt;hostname&amp;gt;&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;-p &amp;lt;port&amp;gt;&lt;/code&gt; 인자를 통해 설정할 수 있으며 더 자세한 옵션은 &lt;code class=&quot;highlighter-rouge&quot;&gt;redis-cli --help&lt;/code&gt;를 통해 확인해볼 수 있습니다.&lt;/p&gt;

&lt;h1 id=&quot;installing-redis-more-properly&quot;&gt;Installing Redis more properly&lt;/h1&gt;

&lt;p&gt;Redis를 실행하기 위해서 &lt;code class=&quot;highlighter-rouge&quot;&gt;redis-server&lt;/code&gt;를 직접 실행할 수 있지만, 시스템 부팅시 매번 직접 실행 해줘야하는 번거로움이 있습니다.
보다 나은 방법으로, init script를 통해 매 시스템 부팅시 자동으로 실행되게 할 수 있습니다.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;우선 Redis 설정과 데이터를 저장하기 위한 디렉토리를 생성합니다:&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;mkdir /etc/redis
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;mkdir /var/redis
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;다운받은 Redis 소스의 &lt;strong&gt;utils&lt;/strong&gt; 디렉토리에 있는 init script를 /etc/init.d 디렉토리에 복사합니다. 파일 이름은 사용하는 포트 번호를 포함하는 것이 좋습니다:&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;cp utils/redis_init_script /etc/init.d/redis_6379
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;필요한 경우 init script 내의 항목을 수정합니다:&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;vi /etc/init.d/redis_6379
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;다음으로, 다운받은 Redis 소스에서 설정 템플릿 파일을 /etc/redis/ 디렉토리에 포트번호를 이름으로 지정하여 복사합니다:&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;cp redis.conf /etc/redis/6379.conf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;Redis 인스턴스가 사용하는 디렉토리를 생성합니다:&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;mkdir /var/redis/6379
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;설정 파일(&lt;strong&gt;/etc/redis/6379.conf&lt;/strong&gt;)에서 다음 항목들을 수정합니다:
    &lt;ul&gt;
      &lt;li&gt;&lt;strong&gt;daemonize&lt;/strong&gt; yes&lt;/li&gt;
      &lt;li&gt;&lt;strong&gt;pidfile&lt;/strong&gt; /var/run/redis_6379.pid&lt;/li&gt;
      &lt;li&gt;&lt;strong&gt;port&lt;/strong&gt; 6379 (원하는 포트로 변경)&lt;/li&gt;
      &lt;li&gt;&lt;strong&gt;logfile&lt;/strong&gt; /var/log/redis_6379.log&lt;/li&gt;
      &lt;li&gt;&lt;strong&gt;dir&lt;/strong&gt; /var/redis/6379&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;마지막으로, Redis init script를 등록합니다:&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;update-rc.d redis_6379 defaults
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;이제 다음 명령을 통해 Redis 서버를 실행 가능하며, 재부팅시에도 자동으로 Redis 인스턴스가 실행됩니다:&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt; /etc/init.d/redis_6379 start
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;performance-tips-for-redis-cache-server&quot;&gt;Performance tips for Redis Cache Server&lt;/h1&gt;

&lt;p&gt;Redis 서버의 성능을 높이기 위해서는, 설치 후 몇가지 설정을 해주어야합니다.
Redis를 설치하고 바로 실행하면 3개의 경고(WARNING) 메시지가 출력되며 설정을 변경할 것을 제안합니다.&lt;/p&gt;

&lt;h2 id=&quot;raise-somaxconn-above-511&quot;&gt;Raise somaxconn above 511&lt;/h2&gt;

&lt;blockquote&gt;
  &lt;p&gt;# WARNING: The TCP backlog setting of 511 cannot be enforced because /proc/sys/net/core/somaxconn is set to the lower value of 128.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;somaxconn&lt;/code&gt;은 ‘Socket Max Connection’의 약어로 최대 연결 개수를 뜻합니다.
리눅스의 경우 메모리가 128MB 보다 작을 경우 128이 기본이고, 클 경우 1024가 기본입니다.&lt;/p&gt;

&lt;p&gt;동시에 너무 많은 요청이 올 경우, 예를 들어, somaxconn 값이 128일 경우 그 이상 요청이 오는 것에 대해서는 연결을 거부하게 됩니다.&lt;/p&gt;

&lt;p&gt;해당 값을 변경하기 위해서, 다음과 같이 수행할 수 있습니다 (설정은 재부팅 후 적용됩니다):&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;sed &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'$i \sysctl -w net.core.somaxconn=511\n'&lt;/span&gt; /etc/rc.local
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;p&gt;&lt;strong&gt;NOTE&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;docker-compose&lt;/strong&gt;를 사용하는 경우, &lt;code class=&quot;highlighter-rouge&quot;&gt;docker-compose.yml&lt;/code&gt;의 Redis 설정에 다음 내용을 추가하여 반영 가능합니다:&lt;/p&gt;

&lt;div class=&quot;language-yaml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;na&quot;&gt;redis&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;redis&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;sysctls&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;net.core.somaxconn&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;511&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;docker run&lt;/strong&gt;을 통해 Redis 서버를 실행하는 경우, 실행시 &lt;code class=&quot;highlighter-rouge&quot;&gt;--sysctl net.core.somaxconn=511&lt;/code&gt; 인자를 추가하여 실행합니다:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;docker run &lt;span class=&quot;nt&quot;&gt;--name&lt;/span&gt; some-redis &lt;span class=&quot;nt&quot;&gt;--sysctl&lt;/span&gt; net.core.somaxconn&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;511 &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; redis
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;vmovercommit_memory--1&quot;&gt;vm.overcommit_memory = 1&lt;/h2&gt;

&lt;blockquote&gt;
  &lt;p&gt;# WARNING overcommit_memory is set to 0! Background save may fail under low memory condition. To fix this issue add ‘vm.overcommit_memory = 1’ to /etc/sysctl.conf and then reboot or run the command ‘sysctl vm.overcommit_memory=1’ for this to take effect.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;해당 경고에 대해서는 다음과 같이 수행하여 설정값을 변경해줍니다:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;sed &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'$a\ \n# ensure redis background save issue\nvm.overcommit_memory = 1\n\nsystctl vm.overcommit_memory=1'&lt;/span&gt; /etc/sysctl.conf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;disable-thp&quot;&gt;Disable THP&lt;/h2&gt;

&lt;blockquote&gt;
  &lt;p&gt;# WARNING you have Transparent Huge Pages (THP) support enabled in your kernel. 
This will create latency and memory usage issues with Redis.
To fix this issue run the command ‘echo never &amp;gt; /sys/kernel/mm/transparent_hugepage/enabled’ as root, and add it to your /etc/rc.local in order to retain the setting after a reboot.
Redis must be restarted after THP is disabled.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Transparent Hug Pages (THP)는 대량의 메모리를 관리하기 위한 한 방법으로, 페이지 크기를 확대(2MB or 1GB)하여 사용하는 방법입니다.
THP는 성능 개선을 목적으로하며, 대부분의 시스템 설정의 성능을 향상시키지만 DB와 같은 특정 상황에 대해서는 오히려 성능이 악화될 수 있습니다.&lt;/p&gt;

&lt;p&gt;Redis는 실행 시 THP가 enabled 되어 있는 경우 경고 메시지를 출력하며, 해당 기능을 끄도록 제안하고 있습니다.&lt;/p&gt;

&lt;p&gt;해당 기능은 아래와 같은 명령을 수행하는 것으로 끌 수 있습니다:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;echo &lt;/span&gt;never | &lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;tee /sys/kernel/mm/transparent_hugepage/enabled
&lt;span class=&quot;nb&quot;&gt;echo &lt;/span&gt;never | &lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;tee /sys/kernel/mm/transparent_hugepage/defrag
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;시스템 시작시 마다 해당 명령이 수행되도록 하기 위해 &lt;strong&gt;/etc/rc.local&lt;/strong&gt; 파일에 명령을 추가해 놓을 수 있습니다:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;sed &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'$i \echo never &amp;gt; /sys/kernel/mm/transparent_hugepage/enabled'&lt;/span&gt; /etc/rc.local
&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;sed &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'$i \echo never &amp;gt; /sys/kernel/mm/transparent_hugepage/defrag\n'&lt;/span&gt; /etc/rc.local
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;p&gt;&lt;strong&gt;NOTE&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Docker를 사용하는 경우 &lt;strong&gt;/etc/rc.local&lt;/strong&gt; 파일이 &lt;code class=&quot;highlighter-rouge&quot;&gt;Read-only&lt;/code&gt;로 설정되어 있어서 설정을 변경할 수 없습니다. 
하지만 설정 확인(&lt;code class=&quot;highlighter-rouge&quot;&gt;cat /sys/kernel/mm/transparent_hugepage/enabled&lt;/code&gt;) 시 &lt;code class=&quot;highlighter-rouge&quot;&gt;madvise&lt;/code&gt;로 되어 있고, 메모리 사용 확인(&lt;code class=&quot;highlighter-rouge&quot;&gt;cat /proc/meminfo&lt;/code&gt;)시 HugePages를 사용하고 있지 않은 것 같습니다.&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;참고&quot;&gt;참고&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://redis.io/topics/quickstart&quot;&gt;Redis Quick Start&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.techandme.se/performance-tips-for-redis-cache-server/&quot;&gt;Performance tips for Redis Cache Server&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://allthatlinux.com/dokuwiki/doku.php?id=thp_transparent_huge_pages_%EA%B8%B0%EB%8A%A5%EA%B3%BC_%EC%84%A4%EC%A0%95_%EB%B0%A9%EB%B2%95&quot;&gt;THP(Transparent Huge Pages) 기능과 설정 방법&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><author><name>Youngsup Oh</name></author><category term="Redis" /><category term="Getting started" /><summary type="html">Prerequisites</summary></entry><entry><title type="html">Git Commit Message</title><link href="/git-commit-message" rel="alternate" type="text/html" title="Git Commit Message" /><published>2018-03-18T14:42:22+00:00</published><updated>2018-03-18T14:42:22+00:00</updated><id>/git-commit-message</id><content type="html" xml:base="/git-commit-message">&lt;h1 id=&quot;tldr&quot;&gt;tl;dr&lt;/h1&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;첫 줄의 제목은 50자 이내의 명령문으로 작성하며, 대문자로 시작하고 마침표를 사용하지 않는다.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;두번째 줄은 제목과 본문을 구분하기 위해 비운다.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;나머지 줄에는 구체적으로 어떤 문제를 해결하고 왜 해결해야 했는지 적는다.&lt;/p&gt;
    &lt;ul&gt;
      &lt;li&gt;Explain what and why, not how&lt;/li&gt;
      &lt;li&gt;Wrap the body at 72 characters&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Commit message template:&lt;/p&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# If applied, this commit will...

# Explain why this change is being made

# Provide links to any relevant tickets, articles or other resources
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;커밋 메시지 템플릿을 적용하기 위해, 위의 내용을 파일로 저장하고(e.g., ~/.git_commit_msg.txt) 다음 명령을 실행한다:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;git config &lt;span class=&quot;nt&quot;&gt;--global&lt;/span&gt; commit.template ~/.git_commit_msg.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/git/git-commit-template.png&quot; alt=&quot;git-commit-template&quot; /&gt;&lt;/p&gt;

&lt;h1 id=&quot;구체적인-작성-요령&quot;&gt;구체적인 작성 요령&lt;/h1&gt;

&lt;h2 id=&quot;1-첫-줄제목-행은-무엇을-끝냈는지-명령문으로-작성&quot;&gt;1. 첫 줄(제목 행)은 무엇을 끝냈는지 명령문으로 작성&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;명령문은 Git 커밋 제목 행에 완벽하게 부합한다.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Git 자체가 우리 대신 자동으로 커밋을 생성하는 경우, 명령조를 사용한다.&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;아래 문장에 커밋 내용을 대입하였을 때 문장으로써 적절하면, 그것은 적절한 Git 커밋 제목 행이다.&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;If applied, this commit will &lt;strong&gt;your subject line here&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;만약 이 커밋이 적용되면 이 커밋은 &lt;strong&gt;커밋 제목 행을 여기에&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;좋은 예&lt;/strong&gt;:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;If applied, this commit will &lt;strong&gt;refactor subsystem X for readability&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;If applied, this commit will &lt;strong&gt;update getting started documentation&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;If applied, this commit will &lt;strong&gt;remove deprecated methods&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;If applied, this commit will &lt;strong&gt;release version 1.0.0&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;If applied, this commit will &lt;strong&gt;merge pull request #123 from user/branch&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;만약 이 커밋이 적용되면 이 커밋은 &lt;strong&gt;가독성을 위해 서브시스템 X를 리팩토링한다&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;만약 이 커밋이 적용되면 이 커밋은 &lt;strong&gt;Getting Started 문서를 갱신한다&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;만약 이 커밋이 적용되면 이 커밋은 &lt;strong&gt;Deprecated된 메소드를 삭제한다&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;만약 이 커밋이 적용되면 이 커밋은 &lt;strong&gt;버전 1.0.0으로 판올림한다&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;만약 이 커밋이 적용되면 이 커밋은 &lt;strong&gt;someuser/somebranch에서 온 pull request #123을 병합한다&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;안좋은 예&lt;/strong&gt;:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;If applied, this commit will &lt;strong&gt;fixed bug with Y&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;If applied, this commit will &lt;strong&gt;changing behavior of X&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;If applied, this commit will &lt;strong&gt;more fixes for broken stuff&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;If applied, this commit will &lt;strong&gt;sweet new API methods&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;만약 이 커밋이 적용되면 이 커밋은 &lt;strong&gt;Y로 버그가 고쳐짐&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;만약 이 커밋이 적용되면 이 커밋은 &lt;strong&gt;X 동작 변화&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;만약 이 커밋이 적용되면 이 커밋은 &lt;strong&gt;망가진 것을 좀 더 고친 것들&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;만약 이 커밋이 적용되면 이 커밋은 &lt;strong&gt;좋은 새 API 메소드&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;1-1-영문의-커밋-메시지는-과거형으로-작성하지-않는다&quot;&gt;1-1. 영문의 커밋 메시지는 과거형으로 작성하지 않는다.&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Fixed 대신 Fix, Added 대신 Add, Changed 대신 Change 로 작성&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;1-2-첫-줄의-끝에는-마침표를-사용하지-않는다&quot;&gt;1-2. 첫 줄의 끝에는 마침표를 사용하지 않는다.&lt;/h3&gt;

&lt;h2 id=&quot;2-첫-줄은-50자-내로-나머지-줄은-72자-단위로-개행한다&quot;&gt;2. 첫 줄은 50자 내로, 나머지 줄은 72자 단위로 개행한다.&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;vim을 에디터로 사용 하는 경우 &lt;code class=&quot;highlighter-rouge&quot;&gt;~/.vimrc&lt;/code&gt; 설정에 다음을 추가:&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;autocmd Filetype gitcommit setlocal spell textwidth=72 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;vim을 에디터로 설정하기:&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ git config --global core.editor vim
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;화면 예시:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/git/git-commit-vim.png&quot; alt=&quot;git-commit-vim&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;3-두-번째-줄은-항상-비워-둠&quot;&gt;3. 두 번째 줄은 항상 비워 둠&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;제목과 본문을 구별하기 위함.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;4-나머지-줄은-항상-자세하게-설명&quot;&gt;4. 나머지 줄은 항상 자세하게 설명&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;코드에 어떠한 문제가 있었는지, 왜 그 문제가 발생했는지, 최종적으로 새로 작성한 수정 코드는 어떤 코드인지 최대한 자세하게 설명&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;어떻게 보다는 무엇과 왜를 설명한다(어떤게는 코드가 설명한다)&lt;/strong&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Issue 를 닫거나 할 때는 &lt;a href=&quot;https://help.github.com/articles/closing-issues-via-commit-messages/&quot;&gt;Closing issues via commit messages&lt;/a&gt; 가이드 라인에 맞춰 메시지를 작성&lt;/p&gt;
    &lt;ul&gt;
      &lt;li&gt;예를 들어, 커밋 메시지에 &lt;code class=&quot;highlighter-rouge&quot;&gt;fixes #1&lt;/code&gt;과 같이 작성하면 해당 이슈가 자동으로 닫힘.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;5-커밋-메시지-제목의-첫-글자는-대문자로-시작영어로-작성하는-경우&quot;&gt;5. 커밋 메시지 제목의 첫 글자는 대문자로 시작(영어로 작성하는 경우)&lt;/h2&gt;

&lt;h2 id=&quot;6-제목-줄에-무엇을-추가했는지-적었고-더-이상-설명할-필요가-없어도-해당-커밋이-무엇을-의미하는지-어떤-역할을-할-수-있는지에-대해-추가로-작성&quot;&gt;6. 제목 줄에 무엇을 추가했는지 적었고 더 이상 설명할 필요가 없어도 해당 커밋이 무엇을 의미하는지, 어떤 역할을 할 수 있는지에 대해 추가로 작성&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/ejmr/php-mode/commit/ac392ad5f0151a90d753592c4a71ce04b8f99fb3&quot;&gt;예시1&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/ejmr/php-mode/commit/d084cffbf7095b1ebe9090ad18d475c7ba6eba74&quot;&gt;예시2&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;왜 이 커밋을 착성했는지에 대해 추가로 작성하면 더 좋음: &lt;a href=&quot;https://github.com/ejmr/php-mode/commit/7f02722d5aa60d9a95a0560a439e38f80d5e5e87&quot;&gt;예시&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&quot;7-가능한-간결하게-문법에-맞게-작성&quot;&gt;7. 가능한 간결하게 문법에 맞게 작성&lt;/h2&gt;

&lt;h2 id=&quot;참고&quot;&gt;참고&lt;/h2&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://tech.ssut.me/2015/06/24/write-a-good-git-commit-message/&quot;&gt;좋은 깃(Git) 커밋 메시지 작성하기&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://chris.beams.io/posts/git-commit/&quot;&gt;How to Write a Git Commit Message&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://item4.github.io/2016-11-01/How-to-Write-a-Git-Commit-Message/&quot;&gt;How to Write a Git Commit Message(번역)&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://codeinthehole.com/tips/a-useful-template-for-commit-messages/&quot;&gt;A useful template for commit messages&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><author><name>Youngsup Oh</name></author><category term="git" /><summary type="html">tl;dr</summary></entry></feed>